<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUIZZONE  RSD1A</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
        }
        .question-container {
            margin-top: 20px;
        }
        .question-button {
            font-size: 16px;
            padding: 10px;
            margin: 5px;
            cursor: pointer;
        }
        .delete-icon {
            color: red;
            font-size: 18px;
            cursor: pointer;
            margin-left: 10px;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .applause-button {
            font-size: 18px;
            background-color: green;
            color: white;
            padding: 10px;
            cursor: pointer;
            margin-top: 20px;
        }
        .applause-icon {
            font-size: 24px;
            margin-right: 10px;
        }
    </style>
</head>
<body>

    <h1>QUIZZONE  RSD1A</h1>
    
    <div>
        <input type="text" id="question-input" placeholder="Aggiungi una nuova domanda" />
        <button onclick="addQuestion()">Aggiungi</button>
    </div>

    <div>
        <button onclick="clearQuestions()">CANCELLA FRASI</button>
    </div>

    <div class="question-container" id="questions-container">
        <!-- Domande appariranno qui -->
    </div>

    <div id="correct-response-container">
        <!-- Il pulsante di applauso appare qui dopo una risposta corretta -->
    </div>

    <script>
        // Funzione per gestire il sintetizzatore vocale
        function speak(text) {
            text = text.replace(/l'/g, 'l apostrofo ').replace(/'/g, '');
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.rate = 0.5;
            speechSynthesis.speak(utterance);
        }

        // Funzione per aggiungere una domanda
        function addQuestion() {
            const input = document.getElementById("question-input");
            const question = input.value.trim();
            if (question) {
                const container = document.getElementById("questions-container");

                // Crea un bottone per la domanda
                const button = document.createElement("button");
                button.className = "question-button";
                button.textContent = question;
                button.onclick = function() { speak(question); };

                // Crea un'icona di eliminazione per la domanda
                const deleteIcon = document.createElement("span");
                deleteIcon.className = "delete-icon";
                deleteIcon.textContent = "‚ùå";
                deleteIcon.onclick = function() { deleteQuestion(question, button, deleteIcon); };

                // Aggiungi bottone e icona nella UI
                const div = document.createElement("div");
                div.appendChild(button);
                div.appendChild(deleteIcon);
                container.appendChild(div);

                // Aggiungi la domanda al file
                saveQuestion(question);
                input.value = ""; // Pulisce l'input
            }
        }

        // Funzione per cancellare una domanda
        function deleteQuestion(question, button, deleteIcon) {
            const container = document.getElementById("questions-container");
            container.removeChild(button.parentNode);

            // Invia richiesta per cancellare la domanda dal file
            fetch('/delete', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ question: question })
            });
        }

        // Funzione per cancellare tutte le domande
        function clearQuestions() {
            const container = document.getElementById("questions-container");
            container.innerHTML = ""; // Rimuove tutte le domande visibili

            // Invia richiesta per cancellare tutte le domande dal file
            fetch('/clear', { method: 'POST' });
        }

        // Funzione per salvare una domanda nel file
        function saveQuestion(question) {
            fetch('/add', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ question: question })
            });
        }

        // Funzione per caricare tutte le domande esistenti quando la pagina si carica
        window.onload = function() {
            fetch('/get-questions')
                .then(response => response.json())
                .then(data => {
                    data.questions.forEach(function(question) {
                        const container = document.getElementById("questions-container");

                        // Crea un bottone per la domanda
                        const button = document.createElement("button");
                        button.className = "question-button";
                        button.textContent = question;
                        button.onclick = function() { speak(question); };

                        // Crea un'icona di eliminazione per la domanda
                        const deleteIcon = document.createElement("span");
                        deleteIcon.className = "delete-icon";
                        deleteIcon.textContent = "‚ùå";
                        deleteIcon.onclick = function() { deleteQuestion(question, button, deleteIcon); };

                        // Aggiungi bottone e icona nella UI
                        const div = document.createElement("div");
                        div.appendChild(button);
                        div.appendChild(deleteIcon);
                        container.appendChild(div);
                    });
                });
        };

        // Funzione per gestire la risposta corretta
        function showApplause() {
            // Crea il pulsante di applauso
            const applauseContainer = document.getElementById("correct-response-container");
            applauseContainer.innerHTML = ''; // Rimuove precedenti pulsanti di applauso
            const applauseButton = document.createElement("button");
            applauseButton.className = "applause-button";
            applauseButton.innerHTML = '<span class="applause-icon">üëè</span> Bravo!';

            applauseButton.onclick = function() {
                playApplauseSound();
            };

            applauseContainer.appendChild(applauseButton);
        }

        // Funzione per riprodurre il suono dell'applauso
        function playApplauseSound() {
            const audio = new Audio('applause.mp3');  // Assicurati che il file applause.mp3 sia nella stessa cartella
            audio.play();
        }

        // Simuliamo una risposta corretta per esempio (puoi modificarlo)
        // Mostra il pulsante di applauso dopo una risposta corretta
        showApplause();
    </script>

</body>
</html>
